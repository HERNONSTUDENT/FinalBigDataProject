{"name":"Get_Weather_Details","ppdf:dataflowId":"3f2b799f-43bd-4c3b-bac4-8f2bf777090d","ppdf:owner":{"tenantId":"47855545-00bb-4800-a65f-e79104ec0fc4","userId":"a303ecf4-95b3-4c32-baec-e595dfc1b6c3"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-GB","modifiedTime":"2025-04-23T10:46:55.8712131+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"Query":{"queryId":"0805249c-6c9d-42e3-8de0-b9243953e388","queryName":"Query"},"Query_DataDestination":{"queryId":"cef3e836-1a34-4626-a161-780836fd0a5f","queryName":"Query_DataDestination"},"Query_WriteToDataDestination":{"queryId":"8a12487f-ebf5-462c-a185-5321467731c1","queryName":"Query_WriteToDataDestination"},"Query_TransformForWriteToDataDestination":{"queryId":"832b352e-79b9-4f47-8799-9090e2200143","queryName":"Query_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"2241b07a-d2a5-44fd-b5e3-20d5aa4f02ff","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared Query = let\r\n  Source = Json.Document(Web.Contents(\"https://api.openweathermap.org/data/2.5/weather?q=New York&units=metric&appid=140894e8db55c6c75021bf9e781a202f\")),\r\n  #\"Converted to table\" = Table.FromRecords({Source}),\r\n  #\"Expanded coord\" = Table.ExpandRecordColumn(#\"Converted to table\", \"coord\", {\"lon\", \"lat\"}, {\"coord.lon\", \"coord.lat\"}),\r\n  #\"Expanded weather\" = Table.ExpandListColumn(#\"Expanded coord\", \"weather\"),\r\n  #\"Expanded weather1\" = Table.ExpandRecordColumn(#\"Expanded weather\", \"weather\", {\"id\", \"main\", \"description\", \"icon\"}, {\"weather.id\", \"weather.main\", \"weather.description\", \"weather.icon\"}),\r\n  #\"Expanded main\" = Table.ExpandRecordColumn(#\"Expanded weather1\", \"main\", {\"temp\", \"feels_like\", \"temp_min\", \"temp_max\", \"pressure\", \"humidity\", \"sea_level\", \"grnd_level\"}, {\"main.temp\", \"main.feels_like\", \"main.temp_min\", \"main.temp_max\", \"main.pressure\", \"main.humidity\", \"main.sea_level\", \"main.grnd_level\"}),\r\n  #\"Expanded wind\" = Table.ExpandRecordColumn(#\"Expanded main\", \"wind\", {\"speed\", \"deg\"}, {\"wind.speed\", \"wind.deg\"}),\r\n  #\"Expanded clouds\" = Table.ExpandRecordColumn(#\"Expanded wind\", \"clouds\", {\"all\"}, {\"clouds.all\"}),\r\n  #\"Expanded sys\" = Table.ExpandRecordColumn(#\"Expanded clouds\", \"sys\", {\"type\", \"id\", \"country\", \"sunrise\", \"sunset\"}, {\"sys.type\", \"sys.id\", \"sys.country\", \"sys.sunrise\", \"sys.sunset\"}),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Expanded sys\", {{\"coord.lon\", type number}, {\"coord.lat\", type number}, {\"weather.id\", Int64.Type}, {\"weather.main\", type text}, {\"weather.description\", type text}, {\"weather.icon\", type text}, {\"base\", type text}, {\"main.temp\", type number}, {\"main.feels_like\", type number}, {\"main.temp_min\", type number}, {\"main.temp_max\", type number}, {\"main.pressure\", Int64.Type}, {\"main.humidity\", Int64.Type}, {\"main.sea_level\", Int64.Type}, {\"main.grnd_level\", Int64.Type}, {\"visibility\", Int64.Type}, {\"wind.speed\", type number}, {\"wind.deg\", Int64.Type}, {\"clouds.all\", Int64.Type}, {\"dt\", Int64.Type}, {\"sys.type\", Int64.Type}, {\"sys.id\", Int64.Type}, {\"sys.country\", type text}, {\"sys.sunrise\", Int64.Type}, {\"sys.sunset\", Int64.Type}, {\"timezone\", Int64.Type}, {\"id\", Int64.Type}, {\"name\", type text}, {\"cod\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared Query_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"dc32af3f-4646-46af-a08a-e5eb802becef\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"d3c817e9-a313-44ef-8476-65574940e6b6\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"Weather_Raw_DF\", ItemKind = \"Table\"]}[Data]\r\nin\r\n  TableNavigation;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared Query_WriteToDataDestination = let\r\n  Query_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = Query_DataDestination], (txn) => {TableAction.InsertRows(txn[Target], Query_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  Query_WriteToDataDestination;\r\nshared Query_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(Query, {\"coord.lon\", \"coord.lat\", \"weather.id\", \"weather.main\", \"weather.description\", \"weather.icon\", \"base\", \"main.temp\", \"main.feels_like\", \"main.temp_min\", \"main.temp_max\", \"main.pressure\", \"main.humidity\", \"main.sea_level\", \"main.grnd_level\", \"visibility\", \"wind.speed\", \"wind.deg\", \"clouds.all\", \"dt\", \"sys.type\", \"sys.id\", \"sys.country\", \"sys.sunrise\", \"sys.sunset\", \"timezone\", \"id\", \"name\", \"cod\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"https://api.openweathermap.org/data/2.5/weather?q=New York&units=metric&appid=140894e8db55c6c75021bf9e781a202f","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://api.openweathermap.org/data/2.5/weather?q=New York&units=metric&appid=140894e8db55c6c75021bf9e781a202f\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]}}